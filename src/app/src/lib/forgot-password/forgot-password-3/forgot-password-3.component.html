<div
  class="forgot-password-3-container min-h-screen flex items-center justify-center p-4"
  data-testid="forgot-password-3-container"
  >
  <div
    class="forgot-password-3-wrapper max-w-4xl w-full flex flex-col md:flex-row overflow-hidden"
    data-testid="forgot-password-3-wrapper"
    >
    <!-- Left side decorative panel -->
    <div
      class="bg-gradient-to-br from-primary-600 to-primary-900 text-white p-8 md:w-2/5 flex flex-col justify-between"
      data-testid="forgot-password-3-left-panel"
      >
      <div data-testid="forgot-password-3-left-header">
        <h1 class="text-3xl font-bold mb-4" data-testid="forgot-password-3-left-title">
          Password Recovery
        </h1>
        <p class="text-primary-100 mb-6" data-testid="forgot-password-3-left-subtitle">
          We'll help you regain access to your account in just a few steps.
        </p>
      </div>

      <div class="hidden md:block" data-testid="forgot-password-3-left-graphic">
        <svg
          class="w-full h-auto"
          fill="none"
          viewBox="0 0 900 600"
          xmlns="http://www.w3.org/2000/svg"
          >
          <path
            d="M0 549.5L21.5 546.2C43 542.8 86 536.2 129.2 534.5C172.3 532.8 215.7 536.2 258.8 545.3C302 554.5 345 569.5 388.2 564.3C431.3 559.2 474.7 533.8 517.8 528.3C561 522.8 604 537.2 647.2 539.5C690.3 541.8 733.7 532.2 776.8 530.7C820 529.2 863 535.8 884.5 539.2L906 542.5V601H884.5C863 601 820 601 776.8 601C733.7 601 690.3 601 647.2 601C604 601 561 601 517.8 601C474.7 601 431.3 601 388.2 601C345 601 302 601 258.8 601C215.7 601 172.3 601 129.2 601C86 601 43 601 21.5 601H0V549.5Z"
            fill="rgba(255,255,255,0.2)"
            />
          <circle cx="776.5" cy="222.5" fill="rgba(255,255,255,0.1)" r="38.5" />
          <circle cx="116.5" cy="167.5" fill="rgba(255,255,255,0.1)" r="24.5" />
          <circle cx="446.5" cy="367.5" fill="rgba(255,255,255,0.1)" r="48.5" />
        </svg>
      </div>
    </div>

    <!-- Right side form panel -->
    <div class="p-8 md:w-3/5" data-testid="forgot-password-3-right-panel">
      @if (!resetLinkSent()) {
        <div class="text-center md:text-left mb-8" data-testid="forgot-password-3-right-header">
          <h2 class="text-2xl font-bold" data-testid="forgot-password-3-right-title">
            {{ title }}
          </h2>
          <p class="mt-1" data-testid="forgot-password-3-right-subtitle">
            Enter your email to receive a reset link
          </p>
        </div>
        <form
          (ngSubmit)="onSubmit()"
          [formGroup]="forgotPasswordForm"
          class="space-y-6"
          data-testid="forgot-password-3-form"
          >
          <!-- Email input -->
          <div data-testid="forgot-password-3-email-field">
            <lib-input-text
              [config]="emailConfig"
              [errorMessage]="submitted && email?.errors ?
                (email?.errors?.['required'] ? 'Email is required' :
                 email?.errors?.['email'] ? 'Please enter a valid email address' : '') : ''"
              data-testid="forgot-password-3-email-input"
              formControlName="email"
              />
          </div>
          <!-- Error message if provided -->
          @if (forgotPasswordError) {
            <div
              class="p-error mt-2"
              data-testid="forgot-password-3-error"
              >
              {{ forgotPasswordError }}
            </div>
          }
          <!-- Submit button -->
          <button
            [disabled]="forgotPasswordForm.invalid || isSubmitting"
            [loading]="isSubmitting"
            aria-label="Send Reset Link"
            class="w-full p-3 text-center"
            data-testid="forgot-password-3-submit-button"
            icon="pi pi-envelope"
            iconPos="right"
            label="Send Reset Link"
            pButton
            pRipple
            type="submit"
          ></button>
          <!-- Login link -->
          @if (features.showLoginLink) {
            <div
              class="text-center text-sm"
              data-testid="forgot-password-3-login-section"
              >
              Remember your password?
              <a
                (click)="navigateToLogin()"
                (keydown.enter)="navigateToLogin()"
                class="text-primary-600 hover:text-primary-800 hover:underline cursor-pointer font-medium ml-1"
                data-testid="forgot-password-3-login-link"
                tabindex="0"
                >
                Back to login
              </a>
            </div>
          }
        </form>
      }

      @if (resetLinkSent()) {
        <div
          class="flex flex-col items-center justify-center py-8"
          data-testid="forgot-password-3-success"
          >
          <div
            class="w-20 h-20 flex items-center justify-center mb-6"
            data-testid="forgot-password-3-success-icon"
            >
            <i class="pi pi-envelope-open text-green-500 text-4xl"></i>
          </div>
          <h3 class="text-2xl font-bold mb-2" data-testid="forgot-password-3-success-title">
            Check Your Email
          </h3>
          <p class="text-center mb-8 max-w-sm" data-testid="forgot-password-3-success-message">
            We've sent a password reset link to your email address. The link will expire in 30
            minutes.
          </p>
          <button
            (click)="navigateToLogin()"
            aria-label="Back to Login"
            class="w-full md:w-2/3"
            data-testid="forgot-password-3-back-button"
            label="Return to Login"
            pButton
            pRipple
            type="button"
          ></button>
        </div>
      }
    </div>
  </div>
</div>

<p-toast />
